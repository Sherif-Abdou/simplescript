extern def log(x: f64): f64
extern def putchar(x: char): i64
extern def gets(buffer: &char): &char
extern def malloc(size: i64): &char
extern def realloc(ptr: &char, size: i64): &char
extern def puts(str: &char): i64
extern def free(ptr: &char)

struct String {
    internal: &char,
    capacity: i64,
    len: i64
}

def make_string(capacity: i64): String {
    s = String()
    s.capacity = capacity
    s.len = 0
    s.internal = malloc(capacity)

    return s
}

def string_append_char(s: &String, c: char): i64 {
    if s->len > s->capacity {
        s->capacity = s->capacity * 2
        s->internal = realloc(s->internal, s->capacity)
    }
    s->internal[s->len] = c
    s->len = s->len + 1
    return 0
}

def free_string(str: &String): i64 {
    free(s->internal)
    return 0
}

struct Node {
    next: &Node
}

def main(): i64 {
    a = Node()
    b = Node()
    c = Node()
    a.next = &b
    a.next->next = &c
    a.next->next->next = 0

    e = &a
    while e != 0 {
        s = "hello world"
        puts(&s)
        e = e->next
    }

    return 0
}
